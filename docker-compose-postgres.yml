# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘           eCollect Enterprise - Direct PostgreSQL Setup                    â•‘
# â•‘                                                                            â•‘
# â•‘   Fill in YOUR PostgreSQL details below and run:                           â•‘
# â•‘   docker-compose -f docker-compose.postgres.yml up --build                 â•‘
# â•‘                                                                            â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version: '3.8'

services:
  # ============================================================================
  # BACKEND API (Connects to YOUR PostgreSQL)
  # ============================================================================
  backend:
    build: ./backend
    container_name: ecollect-backend
    restart: unless-stopped
    ports:
      - "3001:3001"
    environment:
      # â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
      # â•‘  ğŸ”§ FILL IN YOUR POSTGRESQL DETAILS BELOW                            â•‘
      # â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      # Your PostgreSQL server IP or hostname
      - PG_HOST=_____________YOUR_POSTGRES_HOST_____________
      
      # PostgreSQL port (default is 5432)
      - PG_PORT=5432
      
      # Your database name
      - PG_DATABASE=_____________YOUR_DATABASE_NAME_____________
      
      # Database username
      - PG_USER=_____________YOUR_USERNAME_____________
      
      # Database password
      - PG_PASSWORD=_____________YOUR_PASSWORD_____________
      
      # SSL connection required? (true/false)
      - PG_SSL=false
      
      # â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
      # â•‘  âœ… DONE! No more changes needed below this line.                    â•‘
      # â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3001/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    networks:
      - ecollect-network

  # ============================================================================
  # FRONTEND (React App)
  # ============================================================================
  frontend:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        # Connect frontend to backend API (uses nginx proxy)
        - VITE_API_URL=/api
        # Groq API key for AI features
        - VITE_GROQ_API_KEY=${paste key}
    container_name: ecollect-frontend
    restart: unless-stopped
    ports:
      - "3000:80"
    depends_on:
      backend:
        condition: service_healthy
    networks:
      - ecollect-network

networks:
  ecollect-network:
    driver: bridge

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘                           INSTRUCTIONS                                     â•‘
# â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
# â•‘                                                                            â•‘
# â•‘  1. Fill in YOUR PostgreSQL details in the backend environment section    â•‘
# â•‘                                                                            â•‘
# â•‘  2. Make sure these tables exist in your PostgreSQL database:              â•‘
# â•‘                                                                            â•‘
# â•‘     CREATE TABLE notehis (                                                 â•‘
# â•‘         id INTEGER PRIMARY KEY,                                            â•‘
# â•‘         custnumber TEXT,                                                   â•‘
# â•‘         accnumber TEXT,                                                    â•‘
# â•‘         notemade TEXT,                                                     â•‘
# â•‘         owner TEXT,                                                        â•‘
# â•‘         notedate TEXT,                                                     â•‘
# â•‘         notesrc TEXT,                                                      â•‘
# â•‘         noteimp TEXT,                                                      â•‘
# â•‘         reason TEXT,                                                       â•‘
# â•‘         reasondetails TEXT                                                 â•‘
# â•‘     );                                                                     â•‘
# â•‘                                                                            â•‘
# â•‘     CREATE TABLE sms_logs (                                                â•‘
# â•‘         sms_id BIGINT PRIMARY KEY,                                         â•‘
# â•‘         message TEXT,                                                      â•‘
# â•‘         owner TEXT,                                                        â•‘
# â•‘         customer_number TEXT,                                              â•‘
# â•‘         date_sent TEXT,                                                    â•‘
# â•‘         send_status TEXT,                                                  â•‘
# â•‘         arrears TEXT,                                                      â•‘
# â•‘         phone_number TEXT,                                                 â•‘
# â•‘         stage_date TEXT,                                                   â•‘
# â•‘         reference_number TEXT,                                             â•‘
# â•‘         gw_response JSONB,                                                 â•‘
# â•‘         extra TEXT                                                         â•‘
# â•‘     );                                                                     â•‘
# â•‘                                                                            â•‘
# â•‘  3. Run the system:                                                        â•‘
# â•‘                                                                            â•‘
# â•‘     docker-compose -f docker-compose.postgres.yml up --build               â•‘
# â•‘                                                                            â•‘
# â•‘  4. Access the application:                                                â•‘
# â•‘                                                                            â•‘
# â•‘     http://localhost:3000                                                  â•‘
# â•‘                                                                            â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
